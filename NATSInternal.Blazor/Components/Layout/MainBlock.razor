@namespace NATSInternal.Blazor.Components

<div class="block bg-white rounded-3 p-0 d-flex flex-column">
    <!-- HeaderContent -->
    <div class="block-header bg-opacity-25 border ps-3 p-2 rounded-top-3 d-flex
                align-items-center @GetHeaderClass()"
            style="height: 45px">
        <div class="small fw-bold flex-fill me-2 pt-1 text-@ComputedColor">
            @Title.ToUpper()
        </div>
        @BlockHeaderContent
    </div>
        
    <!-- BodyContent -->
    <div class="rounded-bottom-3 flex-fill @GetBodyClass()">
        @BlockBodyContent
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public string Title { get; set; }

    [Parameter]
    public MainBlockColor Color { get; set; } = MainBlockColor.Primary;

    [Parameter]
    public string HeaderClass { get; set; }

    [Parameter]
    public bool Paginator { get; set; }

    [Parameter]
    public bool BodyClass { get; set; }

    [Parameter]
    public (int Top, int Right, int Bottom, int Left)? BodyPadding { get; set; } = null;

    [Parameter]
    public bool BodyBorder { get; set; } = true;

    [Parameter]
    public RenderFragment BlockHeaderContent { get; set; }

    [Parameter]
    public RenderFragment BlockBodyContent { get; set; }

    private string ComputedColor => Color.ToString().ToLower();

    private string GetHeaderClass()
    {
        string className = $"bg-{ComputedColor}-subtle border-{ComputedColor}-subtle";
        if (HeaderClass != null)
        {
            className += $" {HeaderClass}";
        }

        return className;
    }

    private string GetBodyClass()
    {
        List<string> classNames = new List<string>();
        
        if (BodyPadding.HasValue)
        {
            classNames.AddRange(new string[] 
            {
                $"pt-{BodyPadding.Value.Top}",
                $"pe-{BodyPadding.Value.Right}",
                $"pb-{BodyPadding.Value.Bottom}",
                $"ps-{BodyPadding.Value.Left}"
            });
        }

        if (BodyBorder)
        {
            classNames.Add("border border-top-0");
        }

        return string.Join(" ", classNames);
    }
}
